<div ng-cloak>
    <div class="row">
    	<div class="panel-heading">
    		<h1 translate="warning.greet" translate-values="{username: '{{account.name}}'}">Ola {{account.name}} !</h1>
    		<h3 translate="warning.dashboard">Dashboard Warn A Broda</h3>
    		<hr>
    	</div>
    	
    
    	 <div class="col-md-4">
            <div class="panel panel-primary">
		        <div class="panel-heading">
		        	<h3 class="panel-title" translate="warning.registered_warnings">All warns registered</h3>
		        </div>
		        <div class="panel-body">
		       		<span translate="warning.total">Total:</span> {{warn.All}}	
		       		<br/><br/>

		       		<span translate="warning.total_by_email">Total by E-mail: </span> ( {{(warn.EmailSent*1+warn.EmailNotSent*1) * 100 / warn.All  | number:2}}% - {{(warn.EmailSent*1+warn.EmailNotSent*1)}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{(warn.EmailSent*1+warn.EmailNotSent*1) | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.All | number:0}}"
			                 style="width: {{(warn.EmailSent*1+warn.EmailNotSent*1) * 100 / warn.All  | number:0}}%">
			                {{(warn.EmailSent*1+warn.EmailNotSent*1)}} msgs
			            </div>
			        </div>
			        <span  translate="warning.total_by_sms">Total by SMS: </span> ( {{(warn.SmsSent*1+warn.SmsNotSent*1) * 100 / warn.All  | number:2}}% - {{(warn.SmsSent*1+warn.SmsNotSent*1)}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{(warn.SmsSent*1+warn.SmsNotSent*1) | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.All | number:0}}"
			                 style="width: {{(warn.SmsSent*1+warn.SmsNotSent*1) * 100 / warn.All  | number:0}}%">
			                {{(warn.SmsSent*1+warn.SmsNotSent*1)}} msgs
			            </div>
			        </div>

			        <span  translate="warning.total_by_whatsapp">Total unique contacts: </span> ( {{warn.UniqueContacts * 100 / warn.All  | number:2}}% - {{warn.UniqueContacts}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.UniqueContacts | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.All | number:0}}"
			                 style="width: {{warn.UniqueContacts * 100 / warn.All  | number:0}}%">
			                {{warn.UniqueContacts}} msgs
			            </div>
			        </div>

		        </div>
	        </div>
        </div>
         <div class="col-md-4">
            <div class="panel panel-success">
		        <div class="panel-heading">
		        	<h3 class="panel-title" translate="warning.sent_warnings">Sent warnings</h3>
		        </div>
		        <div class="panel-body">
		        	<span translate="warning.total">Total:</span> ( {{warn.Sent * 100 / warn.All  | number:2}}% - {{warn.Sent}} msgs)
					<div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.Sent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.All | number:0}}"
			                 style="width: {{warn.Sent * 100 / warn.All  | number:0}}%">
			                {{warn.Sent}} msgs
			            </div>
			        </div>
			        <span translate="warning.total_by_email">Total by E-mail: </span> ( {{warn.EmailSent * 100 / warn.Sent  | number:2}}% - {{warn.EmailSent}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.EmailSent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.Sent | number:0}}"
			                 style="width: {{warn.EmailSent * 100 / warn.Sent  | number:0}}%">
			                {{warn.EmailSent}} msgs
			            </div>
			        </div>
			        <span  translate="warning.total_by_sms">Total by SMS: </span> ( {{warn.SmsSent * 100 / warn.Sent  | number:2}}% - {{warn.SmsSent}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.SmsSent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.Sent | number:0}}"
			                 style="width: {{warn.SmsSent * 100 / warn.Sent  | number:0}}%">
			                {{warn.SmsSent}} msgs
			            </div>
			        </div>
			        <span  translate="warning.total_by_whatsapp">Total by WhatsApp: </span> ( {{warn.WhatsappSent * 100 / warn.Sent  | number:2}}% - {{warn.WhatsappSent}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.WhatsappSent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.Sent | number:0}}"
			                 style="width: {{warn.WhatsappSent * 100 / warn.Sent  | number:0}}%">
			                {{warn.WhatsappSent}} msgs
			            </div>
			        </div>
		        </div>
	        </div>
        </div>
         <div class="col-md-4">
            <div class="panel panel-danger">
		        <div class="panel-heading">
		        	<h3 class="panel-title" translate="warning.not_sent_warnings">Not sent warnings</h3>
		        </div>
		        <div class="panel-body">
	        		<span translate="warning.total">Total:</span> ( {{warn.NotSent * 100 / warn.All  | number:2}}% - {{warn.NotSent}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.NotSent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.All | number:0}}"
			                 style="width: {{warn.NotSent * 100 / warn.All  | number:0}}%">
			                {{warn.NotSent}} msgs
			            </div>
			        </div>
			        <span translate="warning.total_by_email">Total by E-mail: </span> ( {{warn.EmailNotSent * 100 / warn.NotSent  | number:2}}% - {{warn.EmailNotSent}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.EmailNotSent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.NotSent | number:0}}"
			                 style="width: {{warn.EmailNotSent * 100 / warn.NotSent  | number:0}}%">
			                {{warn.EmailNotSent}} msgs
			            </div>
			        </div>
			        <span  translate="warning.total_by_sms">Total by SMS: </span> ( {{warn.SmsNotSent * 100 / warn.NotSent  | number:2}}% - {{warn.SmsNotSent}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.SmsNotSent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.NotSent | number:0}}"
			                 style="width: {{warn.SmsNotSent * 100 / warn.NotSent  | number:0}}%">
			                {{warn.SmsNotSent}} msgs
			            </div>
			        </div>
			         <span  translate="warning.total_by_whatsapp">Total by WhatsApp: </span> ( {{warn.WhatsappNotSent * 100 / warn.NotSent  | number:2}}% - {{warn.WhatsappNotSent}} msgs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.WhatsappNotSent | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.Sent | number:0}}"
			                 style="width: {{warn.WhatsappNotSent * 100 / warn.NotSent  | number:0}}%">
			                {{warn.WhatsappNotSent}} msgs
			            </div>
			        </div>
		        </div>
	        </div>
        </div>        
    </div>
    <div class="row">
	    <div class="col-md-4">
	        <div class="panel panel-primary">
		        <div class="panel-heading">
		        	<h3 class="panel-title" translate="warning.ignore_list">Ignore list</h3>
		        </div>
		        <div class="panel-body">
		       		<span translate="warning.total">Total:</span> {{warn.IgnoreList}}	
		       		<br/><br/>

		       		<span translate="warning.total_confirmed">Total Confirmed: </span> ( {{warn.Confirmed * 100 / warn.IgnoreList  | number:2}}% - {{warn.Confirmed}} usrs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.Confirmed | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{warn.Confirmed * 100 / warn.IgnoreList  | number:0}}%">
			                {{warn.Confirmed}} usrs
			            </div>
			        </div>
			        <span  translate="warning.total_unconfirmed">Total Unconfirmed: </span> ( {{warn.Unconfirmed * 100 / warn.IgnoreList  | number:2}}% - {{warn.Unconfirmed}} usrs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.Unconfirmed | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{warn.Unconfirmed * 100 / warn.IgnoreList  | number:0}}%">
			                {{warn.Unconfirmed}} usrs
			            </div>
			        </div>

		        </div>
	        </div>
	    </div>
	    <div class="col-md-4">
	    	<div class="panel panel-warning">
	    		 <div class="panel-heading">
		        	<h3 class="panel-title" translate="warning.ignore_list_email">Ignore list by e-mail</h3>
		        </div>
		        <div class="panel-body">
		        	<span translate="warning.total">Total:</span> ( {{(warn.ConfirmedByEmail*1+warn.UnconfirmedByEmail*1) * 100 / warn.IgnoreList  | number:2}}% - {{(warn.ConfirmedByEmail*1+warn.UnconfirmedByEmail*1)}} usrs)
		        	<div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{(warn.ConfirmedByEmail*1+warn.UnconfirmedByEmail*1) | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{(warn.ConfirmedByEmail*1+warn.UnconfirmedByEmail*1) * 100 / warn.IgnoreList  | number:0}}%">
			                {{(warn.ConfirmedByEmail*1+warn.UnconfirmedByEmail*1)}} usrs
			            </div>
			        </div>
			        <span translate="warning.total_confirmed">Total Confirmed: </span> ( {{warn.ConfirmedByEmail * 100 / warn.IgnoreList  | number:2}}% - {{warn.ConfirmedByEmail}} usrs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.ConfirmedByEmail | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{warn.ConfirmedByEmail * 100 / warn.IgnoreList  | number:0}}%">
			                {{warn.ConfirmedByEmail}} usrs
			            </div>
			        </div>
			        <span  translate="warning.total_unconfirmed">Total UnconfirmedByEmail: </span> ( {{warn.UnconfirmedByEmail * 100 / warn.IgnoreList  | number:2}}% - {{warn.UnconfirmedByEmail}} usrs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.UnconfirmedByEmail | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{warn.UnconfirmedByEmail * 100 / warn.IgnoreList  | number:0}}%">
			                {{warn.UnconfirmedByEmail}} usrs
			            </div>
			        </div>
		        </div>
	    	</div>
	    </div>
	    <div class="col-md-4">
	    	<div class="panel panel-warning">
	    		 <div class="panel-heading">
		        	<h3 class="panel-title" translate="warning.ignore_list_sms_whatsapp">Ignore list by sms / Whatsapp</h3>
		        </div>
		        <div class="panel-body">
		        	<span translate="warning.total">Total:</span> ( {{(warn.ConfirmedBySms*1+warn.UnconfirmedBySms*1) * 100 / warn.IgnoreList  | number:2}}% - {{(warn.ConfirmedBySms*1+warn.UnconfirmedBySms*1)}} usrs)
		        	<div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{(warn.ConfirmedBySms*1+warn.UnconfirmedBySms*1) | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{(warn.ConfirmedBySms*1+warn.UnconfirmedBySms*1) * 100 / warn.IgnoreList  | number:0}}%">
			                {{(warn.ConfirmedBySms*1+warn.UnconfirmedBySms*1)}} usrs
			            </div>
			        </div>
		        	<span translate="warning.total_confirmed">Total ConfirmedNySms: </span> ( {{warn.ConfirmedBySms * 100 / warn.IgnoreList  | number:2}}% - {{warn.ConfirmedBySms}} usrs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.ConfirmedBySms | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{warn.ConfirmedBySms * 100 / warn.IgnoreList  | number:0}}%">
			                {{warn.ConfirmedBySms}} usrs
			            </div>
			        </div>
			        <span  translate="warning.total_unconfirmed">Total UnconfirmedBySms: </span> ( {{warn.UnconfirmedBySms * 100 / warn.IgnoreList  | number:2}}% - {{warn.UnconfirmedBySms}} usrs)
			        <div class="progress progress-striped">
			            <div class="progress-bar progress-bar-success" role="progressbar"
			                 aria-valuenow="{{warn.UnconfirmedBySms | number:0}}"
			                 aria-valuemin="0"
			                 aria-valuemax="{{warn.IgnoreList | number:0}}"
			                 style="width: {{warn.UnconfirmedBySms * 100 / warn.IgnoreList  | number:0}}%">
			                {{warn.UnconfirmedBySms}} usrs
			            </div>
			        </div>
		        </div>
	    	</div>
	    </div>
    </div>

    <div class="panel panel-primary">
        <div class="panel-heading">        	
        	<h3 class="panel-title" translate="warning.registered_warnings">All warns registered</h3>
        </div>
        <div class="panel-body">
		    <div class="row">
		    	<div class="col-md-4">
		    		<span translate="warning.itens_per_page">Itens per page: </span>
		    		<select ng-model="entryLimit" class="form-control">
			            <option>5</option>
			            <option>10</option>
			            <option>20</option>
			            <option>50</option>
			            <option>100</option>
			        </select>
		    	</div>
		    	<div class="col-md-4">
		    		<span translate="warning.filter_by">Filter by: </span>
			        <input type="text" ng-model="search" ng-change="filter()" placeholder="Filter" class="form-control" />
			    </div>
			    <div class="col-md-4">
			        <h5 translate="warning.paging_status" translate-values="{total: '{{warn.All}}', all: '{{totalItems}}'}">Filtered {{totalItems}} de {{warn.All}} avisos.</h5>
			    </div>
		    </div>
		    <br/>
		    <div class="row">
		    	<div class="col-md-12" ng-show="filteredItems > 0">
			        <table class="table table-striped table-bordered">
			        <thead>
				        <th><span translate="warning.id">Id</span>&nbsp;<a ng-click="sort_by('Id');"><i class="glyphicon glyphicon-sort"></i></a></th>
				        <th><span translate="warning.type">Type</span>&nbsp;<a ng-click="sort_by('ContactType');"><i class="glyphicon glyphicon-sort"></i></a></th>
				        <th><span translate="warning.message">Message</span>&nbsp;<a ng-click="sort_by('Message');"><i class="glyphicon glyphicon-sort"></i></a></th>
				        <th><span translate="warning.contact">Contact</span>&nbsp;<a ng-click="sort_by('Contact');"><i class="glyphicon glyphicon-sort"></i></a></th>
				        <th><span translate="warning.sent">Sent</span>&nbsp;<a ng-click="sort_by('Sent');"><i class="glyphicon glyphicon-sort"></i></a></th>
				        <th><span translate="warning.sent_date">Sent date</span>&nbsp;<a ng-click="sort_by('CreatedDate');"><i class="glyphicon glyphicon-sort"></i></a></th>	        
			        </thead>
			        <tbody>
			            <tr ng-repeat="data in filtered = (list | filter:search | orderBy : predicate :reverse) | startFrom:(currentPage-1)*entryLimit | limitTo:entryLimit" ng-click="warningDetailShowModal(data.Id, data.ContactType, data.Message)" class="hand">
			                <td>{{data.Id}}</td>
			                <td>{{data.ContactType}}</td>
			                <td>{{data.Message}}</td>
			                <td>{{data.Contact}}</td>
			                <td> <span translate="warning.sent_value" translate-values="{sent: {{data.Sent}}}">{{data.Sent && 'Sim' || 'Não'}}</span></td>
			                <td>{{formatDate(data.CreatedDate) | date:'custom'}}</td>
			            </tr>
			        </tbody>
			        </table>
			    </div>
			    <div class="col-md-12" ng-show="filteredItems == 0">
			        <div class="col-md-12">
			            <h4 translate="warning.no_warns_found">No warns found</h4>
			        </div>
			    </div>
			    <div class="col-md-12" ng-show="filteredItems > 0">			 		
			 		<pagination boundary-links="true" total-items="filteredItems" ng-model="currentPage" class="pagination-md" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" max-size="10"></pagination>
			    </div>
		    </div>
       		
        </div>
    </div>
</div>


<div class="modal fade" id="dataModal" tabindex="-1" role="dialog" aria-labelledby="warningLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form name="form" role="form" novalidate
                  class="ng-scope ng-invalid ng-invalid-required ng-dirty ng-valid-minlength"
                  ng-submit="create()">

                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                            ng-click="warningDetailHideModal()">&times;</button>
                    <h4 class="modal-title" id="warningLabel">{{selectedContactType}}: {{selectedMessage}}</h4>
                </div>

                <div class="modal-body">
                    <div class="form-group">	                    
	                    <div class="row ng-scope">
	                    	<div class="col-sm-4">
	                    		<label>Warning Id: </label><br>
	                    		{{warning.id}} - {{warning.lang_key}}
	                    	</div>
	                    </div><br>

	                    <div class="row ng-scope">
	                    	<div class="col-sm-6">
	                    		<label>Message: </label><br>
	                    		{{warning.id_message}} - ({{selectedMessage}})
	                    	</div>
	                    	<div class="col-sm-6">
	                    		<label>Contact Type: </label><br>
	                    		{{warning.id_contact_type}} - ({{selectedContactType}})
	                    	</div>
	                    </div><br>

	                    <div class="row">
	                    	<div class="col-sm-6">
	                    		<label>Contact: </label><br>
	                    		{{warning.contact}}
	                    	</div>
	                    	<div class="col-sm-6">
	                    		<label>Sent: </label><br>	                    		
	                    		<span ng-show="warning.sent == true">
	                    			<span translate="warning.yes">Yes</span>
	                    		</span>
	                    		<span ng-show="warning.sent == false">
	                    			<span translate="warning.no">No</span>
	                    		</span>	                    		
	                    	</div>	                    	
	                    </div><br>

	                    <div class="row">
	                    	<div class="col-sm-12">
	                    		<label>Return Message: </label><br>
	                    		<span style="width:300px;">{{formatReturnMessage(warning)}}</span><br>
	                    	</div>
	                    </div><br>

						<div class="row">
	                    	<div class="col-sm-4">
	                    		<label>Browser: </label><br>
	                    		{{warning.browser}}
	                    	</div>
	                    	<div class="col-sm-4">
	                    		<label>Operating System: </label><br>
	                    		{{warning.operating_system}}
	                    	</div>
	                    	<div class="col-sm-4">
	                    		<label>Device: </label><br>
	                    		{{warning.device}}
	                    	</div>
	                    </div><br>

	                    <div class="row">
	                    	<div class="col-sm-4">
	                    		<label>City: </label><br>
	                    		{{ip.city}}
	                    	</div>
	                    	<div class="col-sm-4">
	                    		<label>Region: </label><br>
	                    		{{ip.region}}
	                    	</div>
	                    	<div class="col-sm-4">
	                    		<label>Country: </label><br>
	                    		{{ip.country}}
	                    	</div>
	                    </div><br>

	                    <div class="row">
						    <div class="col-sm-6">
						    	<label>Ip: </label><br>
						    	{{warning.ip}}
						    </div>
						    <div class="col-sm-6">
						    	<label>HostName: </label><br>
						    	{{ip.hostname}}
						    </div>
						</div><br>

						<div class="row">
						    <div class="col-sm-6">
						    	<label>GeoLocation: </label><br>
						    	{{ip.loc}}
						    </div>
						    <div class="col-sm-6">
						    	<label>Service Provider: </label><br>
						    	{{ip.org}}
						    </div>
						</div><br>

	                    <div class="row">
						    <div class="col-sm-6">
						    	<label>Created Date: </label><br>
						    	{{formatDate(warning.created_date) | date:'custom'}}
						    </div>
						    <div class="col-sm-6">
						    	<label>Last Modified Date: </label><br>
						    	{{formatDate(warning.last_modified_date) | date:'custom'}}
						    </div>
						</div><br>


	                     <div class="row">
	                    	<div class="col-sm-12">
	                    		<label>Raw: </label><br>
	                    		{{warning.raw}}
	                    	</div>
	                    </div><br>

                    </div>
                    <div style="position: relative">
				        <img class="map" src="{{googleMapString(ip.loc)}}"/>
				    </div>


                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="warningDetailHideModal()">
                        <span class="glyphicon glyphicon-ok"></span> Ok
                    </button>                    
                </div>
            </form>
        </div>
    </div>
</div>